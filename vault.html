<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>📖 Shared Love Vault</title>
<style>
  body { font-family: Arial, sans-serif; text-align: center; background: #fff0f5; margin:0; padding:20px; }
  h1 { color: #d63384; margin-top: 20px; }
  h2 { color: #b82d7a; margin: 20px 0; }
  p { margin: 5px 0; }
  button { 
    margin: 5px; padding: 10px 20px; 
    background: #25D366; color: white; border: none; border-radius: 8px; 
    font-size: 16px; cursor: pointer;
  }
  #vault { margin-top:20px; max-height:400px; overflow-y:auto; border:1px solid #d63384; padding:10px; border-radius:8px; background:#ffe6f0; }
  .vault-entry { margin-bottom: 10px; padding: 8px; border-bottom: 1px solid #d63384; border-radius: 5px; background: #fff0f5; }
  .share-btn { background: #128C7E; font-size: 14px; margin-top:5px; }
</style>
</head>
<body>

<h1>📖 Shared Love Vault</h1>

<h2>Vault 💖</h2>
<div id="vault">Loading vault...</div>
<button onclick="shareVault()">Share Whole Vault on WhatsApp 📲</button>

<h2>Add Entry 💌</h2>
<input type="text" id="entryText" placeholder="Write something..." style="width:70%; padding:8px; border-radius:5px; border:1px solid #d63384;">
<select id="entryType" style="padding:8px; border-radius:5px; border:1px solid #d63384;">
  <option value="message">Message</option>
  <option value="plan">Plan</option>
  <option value="promise">Promise</option>
  <option value="song">Song</option>
  <option value="question">Yes/No Question</option>
</select>
<input type="text" id="entryAnswer" placeholder="Answer (for question)" style="width:30%; padding:8px; border-radius:5px; border:1px solid #d63384;">
<button onclick="addEntry()">Add Entry 💖</button>

<script>
// --- Vault Functions ---
function loadVault() {
  const vault = JSON.parse(localStorage.getItem("vault")) || [];
  const vaultDiv = document.getElementById("vault");
  if(vault.length === 0){
    vaultDiv.innerText = "Vault is empty 😘";
    return;
  }

  vaultDiv.innerHTML = "";
  vault.forEach((item, index) => {
    const entryDiv = document.createElement("div");
    entryDiv.className = "vault-entry";
    let content = "";
    if(item.question && item.answer){
      content = `📅 ${item.date} - ${item.type.toUpperCase()}: ${item.question} → ${item.answer} 💖`;
    } else if(item.text){
      content = `📅 ${item.date} - ${item.type.toUpperCase()}: ${item.text} 💖`;
    } else {
      content = `📅 ${item.date} - ${item.type.toUpperCase()}: Data unavailable 💖`;
    }
    entryDiv.innerHTML = content + `<br><button class="share-btn" onclick="shareSingle(${index})">Share This Entry 📲</button>`;
    vaultDiv.appendChild(entryDiv);
  });
  vaultDiv.scrollTop = vaultDiv.scrollHeight;
}

function addEntry() {
  const text = document.getElementById("entryText").value.trim();
  const type = document.getElementById("entryType").value;
  const answer = document.getElementById("entryAnswer").value.trim();
  if(!text && type !== "question") return alert("Please enter something 💖");
  if(type === "question" && !text) return alert("Please enter a question 💖");

  const vault = JSON.parse(localStorage.getItem("vault")) || [];
  vault.push({
    date: new Date().toLocaleDateString(),
    type: type,
    text: type !== "question" ? text : undefined,
    question: type === "question" ? text : undefined,
    answer: type === "question" ? answer : undefined
  });
  localStorage.setItem("vault", JSON.stringify(vault));
  document.getElementById("entryText").value = "";
  document.getElementById("entryAnswer").value = "";
  loadVault();
}

// --- Share Vault ---
function shareVault() {
  const vault = JSON.parse(localStorage.getItem("vault")) || [];
  if(vault.length === 0) return alert("Vault is empty 😘");

  let text = "📖💖 Shared Love Vault 💖📖\n\n";
  vault.forEach(item => {
    if(item.question && item.answer){
      text += `📅 ${item.date} - ${item.type.toUpperCase()}: ${item.question} → ${item.answer} 💖\n`;
    } else if(item.text){
      text += `📅 ${item.date} - ${item.type.toUpperCase()}: ${item.text} 💖\n`;
    } else {
      text += `📅 ${item.date} - ${item.type.toUpperCase()}: Data unavailable 💖\n`;
    }
  });
  const whatsappUrl = "https://wa.me/?text=" + encodeURIComponent(text);
  window.open(whatsappUrl, "_blank");
}

// --- Share Single Entry ---
function shareSingle(index) {
  const vault = JSON.parse(localStorage.getItem("vault")) || [];
  if(!vault[index]) return;
  const item = vault[index];
  let text = "📖💖 Shared Love Vault Entry 💖📖\n\n";
  if(item.question && item.answer){
    text += `📅 ${item.date} - ${item.type.toUpperCase()}: ${item.question} → ${item.answer} 💖`;
  } else if(item.text){
    text += `📅 ${item.date} - ${item.type.toUpperCase()}: ${item.text} 💖`;
  } else {
    text += `📅 ${item.date} - ${item.type.toUpperCase()}: Data unavailable 💖`;
  }
  const whatsappUrl = "https://wa.me/?text=" + encodeURIComponent(text);
  window.open(whatsappUrl, "_blank");
}

// --- Notifications ---
function showReminder(){
  if(Notification.permission === "granted"){
    new Notification("💌 Love Vault Reminder", {
      body: "Don't forget to add a message, plan, or promise today! 💖",
      icon: "https://upload.wikimedia.org/wikipedia/commons/thumb/e/e4/Heart_font_awesome.svg/1024px-Heart_font_awesome.svg.png"
    });
  }
}

if("Notification" in window){
  Notification.requestPermission();
}

function scheduleReminders(){
  const now = new Date();
  const times = [10, 20]; // 10 AM and 8 PM
  times.forEach(hour => {
    let notifTime = new Date();
    notifTime.setHours(hour,0,0,0);
    let delay = notifTime - now;
    if(delay < 0) delay += 24*60*60*1000;
    setTimeout(function(){
      showReminder();
      setInterval(showReminder, 24*60*60*1000);
    }, delay);
  });
}

scheduleReminders();
loadVault();
</script>

<p style="text-align:center; color:#d63384; margin-top:30px; font-weight:bold;">
❤️ CREATED WITH PURE LOVE ❤️ — I LOVE YOU SO MUCH 💖
</p>

</body>
</html>
