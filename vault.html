<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ðŸ“– Shared Love Vault</title>
<style>
  body { font-family: Arial, sans-serif; text-align: center; background: #fff0f5; padding: 20px; }
  h1 { color: #d63384; }
  h2 { color: #a60073; margin-top: 20px; }
  ul { list-style: none; padding: 0; }
  li { margin: 5px 0; padding: 10px; background: #ffe6f0; border-radius: 10px; }
  button { margin: 10px; padding: 10px 15px; border: none; border-radius: 12px; background: #25D366; color: white; cursor: pointer; }
  button:hover { background: #128C7E; }
</style>
</head>
<body>

<h1>ðŸ“– Shared Love Vault</h1>

<h2>Vault History ðŸ’–</h2>
<ul id="vaultList">Loading...</ul>

<button onclick="shareVault()">ðŸ“¤ Share Todayâ€™s Vault on WhatsApp</button>

<script>
const vaultList = document.getElementById("vaultList");

// --- Load vault from localStorage ---
function loadVault() {
  const vault = JSON.parse(localStorage.getItem("vault")) || [];
  vaultList.innerHTML = "";
  vault.forEach(item => {
    const li = document.createElement("li");
    if(item.type === "message") li.textContent = `ðŸ’¬ ${item.date} - ${item.text}`;
    else if(item.type === "plan") li.textContent = `ðŸ“… ${item.date} - ${item.text}`;
    else if(item.type === "song") li.textContent = `ðŸŽµ ${item.date} - ${item.title}: ${item.note}`;
    else if(item.type === "love") li.textContent = `ðŸ’Œ ${item.date} - Q: ${item.question} | A: ${item.answer}`;
    vaultList.appendChild(li);
  });
}

// --- Share today's vault to WhatsApp ---
function shareVault() {
  const vault = JSON.parse(localStorage.getItem("vault")) || [];
  const today = new Date().toLocaleDateString();
  const todayItems = vault.filter(item => item.date === today);
  if(todayItems.length === 0) return alert("No entries for today!");
  
  let message = `ðŸ“–ðŸ’– Vault for ${today} ðŸ’–ðŸ“–\n\n`;
  todayItems.forEach(item => {
    if(item.type === "message") message += `ðŸ’¬ ${item.text}\n`;
    else if(item.type === "plan") message += `ðŸ“… ${item.text}\n`;
    else if(item.type === "song") message += `ðŸŽµ ${item.title}: ${item.note}\n`;
    else if(item.type === "love") message += `ðŸ’Œ Q: ${item.question} | A: ${item.answer}\n`;
  });
  
  const whatsappUrl = "https://wa.me/?text=" + encodeURIComponent(message);
  window.open(whatsappUrl, "_blank");
}

// --- Notifications ---
if (Notification.permission !== "granted") Notification.requestPermission();

function showNotification(title, body) {
  if (Notification.permission === "granted") {
    new Notification(title, { body: body });
  }
}

// Check every minute for reminders
setInterval(() => {
  const now = new Date();
  const hours = now.getHours();
  const minutes = now.getMinutes();

  if (hours === 10 && minutes === 0) {
    showNotification("ðŸ’Œ Reminder", "Don't forget to add a message, plan, song, or love answer today!");
  }

  if (hours === 20 && minutes === 0) {
    showNotification("ðŸ“¤ Vault Reminder", "Share today's Vault to WhatsApp ðŸ’–");
  }
}, 60000);

// --- Refresh vault display ---
loadVault();
setInterval(loadVault, 5000); // refresh every 5 seconds

</script>
</body>
</html>
