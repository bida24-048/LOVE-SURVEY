  <!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>📖 Love Vault</title>
<style>
  body { font-family: Arial, sans-serif; text-align: center; background: #fff0f5; margin:0; padding:20px; }
  h1 { color: #d63384; margin-top: 20px; }
  #vault { margin-top:20px; max-height:500px; overflow-y:auto; border:1px solid #d63384; padding:10px; border-radius:8px; background:#ffe6f0; }
  .vault-entry { margin-bottom: 15px; padding: 10px; border-bottom: 1px solid #d63384; border-radius: 5px; background: #fff0f5; text-align:left; }
  .action-btn { font-size: 14px; margin-top:5px; padding:6px 10px; border-radius:5px; border:none; cursor:pointer; }
  .share-btn { background: #128C7E; color:white; }
  .delete-btn { background: #d63333; color:white; }
  audio { width: 100%; margin-top:5px; }
</style>
</head>
<body>

<h1>📖 Love Vault</h1>

<div>
  <button onclick="shareVault()" class="action-btn share-btn">Share Whole Vault on WhatsApp 📲</button>
  <button onclick="clearVault()" class="action-btn delete-btn">Clear Entire Vault ❌</button>
</div>

<h2>Vault 💖</h2>
<div id="vault">Loading vault...</div>

<script>
// ---- Load Vault ----
function loadVault() {
  const vault = JSON.parse(localStorage.getItem("vault")) || [];
  const vaultDiv = document.getElementById("vault");
  vaultDiv.innerHTML = "";

  if (vault.length === 0) {
    vaultDiv.innerText = "Vault is empty 😘";
    return;
  }

  vault.forEach((item, index) => {
    const entryDiv = document.createElement("div");
    entryDiv.className = "vault-entry";

    if(item.type === "song") {
      const title = item.title || "Untitled";
      const desc = item.desc || "";
      const link  = item.link || "";
      const file  = item.file || "";

      let content = `
        📅 ${item.date || ""} — 🎵 <b>${escapeHTML(title)}</b><br>
        💖 ${escapeHTML(desc)}<br>
        ${link ? `<a href="${escapeURL(link)}" target="_blank">▶️ Open Link</a><br>` : ""}
        ${file ? `<audio controls src="${file}"></audio>` : ""}
      `;
      entryDiv.innerHTML = content + `<br>
        <button class="action-btn share-btn" onclick="shareSingle(${index})">Share 📲</button>
        <button class="action-btn delete-btn" onclick="deleteEntry(${index})">Delete ❌</button>`;
    }

    vaultDiv.appendChild(entryDiv);
  });
}

// ---- Share Vault ----
function shareVault() {
  const vault = JSON.parse(localStorage.getItem("vault")) || [];
  if (vault.length === 0) return alert("Vault is empty 😘");

  let text = "📖💖 Love Vault 💖📖\n\n";
  vault.forEach(item => {
    if(item.type === "song") {
      text += `🎵 ${item.title}\n💖 ${item.desc || ""}\n${item.link || ""}\n${item.date || ""}\n\n`;
    }
  });
  window.open("https://wa.me/?text=" + encodeURIComponent(text), "_blank");
}

// ---- Share Single Entry ----
function shareSingle(index) {
  const vault = JSON.parse(localStorage.getItem("vault")) || [];
  const item = vault[index];
  if(!item) return;
  let text = `🎵 ${item.title}\n💖 ${item.desc || ""}\n${item.link || ""}`;
  window.open("https://wa.me/?text=" + encodeURIComponent(text), "_blank");
}

// ---- Delete Entry ----
function deleteEntry(index) {
  const vault = JSON.parse(localStorage.getItem("vault")) || [];
  if(!vault[index]) return;
  if(confirm("Delete this entry? 💔")) {
    vault.splice(index, 1);
    localStorage.setItem("vault", JSON.stringify(vault));
    loadVault();
  }
}

// ---- Clear Entire Vault ----
function clearVault() {
  if(confirm("Delete all vault entries? 💔")) {
    localStorage.removeItem("vault");
    loadVault();
  }
}

// ---- Helpers ----
function escapeHTML(str="") {
  return String(str)
    .replaceAll("&","&amp;").replaceAll("<","&lt;")
    .replaceAll(">","&gt;").replaceAll('"',"&quot;")
    .replaceAll("'","&#039;");
}
function escapeURL(u="") {
  try { return new URL(u).toString(); } catch { return "#"; }
}

// ---- Init ----
loadVault();
</script>

<p style="text-align:center; color:#d63384; margin-top:30px; font-weight:bold;">
❤️ I LOVE YOU SO MUCH 💖
</p>

</body>
</html>
